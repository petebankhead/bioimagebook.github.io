
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ImageJ: Thresholding &#8212; Introduction to Bioimage Analysis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mycss.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Filters" href="../4-filters/filters.html" />
    <link rel="prev" title="Thresholding" href="thresholding.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script defer data-domain="bioimagebook.github.io" src="https://plausible.io/js/plausible.js"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/book-logo-smaller.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Bioimage Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../README.html">
                    Introduction to Bioimage Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Front matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../0-preamble/acknowledgements/acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../0-preamble/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../0-preamble/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Before we begin
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../0-preamble/preface/preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../0-preamble/reading/reading.html">
   How to read this book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introducing images
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/1-images_and_pixels/images_and_pixels.html">
   Images &amp; pixels
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/1-images_and_pixels/imagej.html">
     ImageJ: Images &amp; pixels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/1-images_and_pixels/python.html">
     Python: Images &amp; pixels
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/2-measurements/measurements.html">
   Measurements &amp; histograms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/2-measurements/imagej.html">
     ImageJ: Measurements &amp; histograms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/2-measurements/python.html">
     Python: Measurements &amp; histograms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/3-bit_depths/bit_depths.html">
   Types &amp; bit-depths
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/3-bit_depths/imagej.html">
     ImageJ: Types &amp; bit-depths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/3-bit_depths/python.html">
     Python: Types &amp; bit-depths
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/4-colors/colors.html">
   Channels &amp; colors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/4-colors/imagej.html">
     ImageJ: Channels &amp; colors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/4-colors/python.html">
     Python: Channels &amp; colors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/5-pixel_size/pixel_size.html">
   Pixel size &amp; dimensions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/5-pixel_size/imagej.html">
     ImageJ:  Pixel size &amp; dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/5-pixel_size/python.html">
     Python:  Pixel size &amp; dimensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../1-concepts/6-files/files.html">
   Files &amp; file formats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/6-files/imagej.html">
     ImageJ: Files &amp; file formats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../1-concepts/6-files/python.html">
     Python: Files &amp; file formats
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Processing &amp; analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-processing_and_analysis/processing_and_analysis.html">
   Image processing &amp; analysis
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2-point_operations/point_operations.html">
   Point operations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-point_operations/imagej.html">
     ImageJ: Point operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="thresholding.html">
   Thresholding
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     ImageJ: Thresholding
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4-filters/filters.html">
   Filters
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4-filters/imagej.html">
     ImageJ: Filters
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5-morph/morph.html">
   Morphological operations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5-morph/imagej.html">
     ImageJ: Morphological operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../6-transforms/transforms.html">
   Image transforms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../6-transforms/imagej.html">
     ImageJ: Image transforms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7-multidimensional_processing/multidimensional_processing.html">
   Multidimensional processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-multidimensional_processing/imagej.html">
     ImageJ: Multidimensional processing
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fluorescence microscopy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../3-fluorescence/1-formation_overview/formation_overview.html">
   From photons to pixels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3-fluorescence/2-formation_spatial/formation_spatial.html">
   Blur &amp; the PSF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3-fluorescence/3-formation_noise/formation_noise.html">
   Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3-fluorescence/4-microscope_types/microscope_types.html">
   Microscopes &amp; detectors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../appendices/next_steps/next_steps.html">
   Beyond this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../appendices/python/python.html">
   Python Primer
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../appendices/macros/macro_intro.html">
   ImageJ: Writing macros
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendices/macros/macro_dog.html">
     Difference of Gaussians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendices/macros/macro_simulating.html">
     Simulating image formation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/bioimagebook/bioimagebook.github.io/main?urlpath=tree/chapters/2-processing/3-thresholding/imagej.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/chapters/2-processing/3-thresholding/imagej.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../../../_sources/chapters/2-processing/3-thresholding/imagej.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-thresholding">
   Global thresholding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-objects">
   Creating objects
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-measuring-rois">
     Generating &amp; measuring ROIs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-labeled-images">
     Generating labeled images
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#local-thresholding">
   Local thresholding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#addendum-practical-issues">
   Addendum: Practical issues
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-nans">
     Using NaNs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram-binning">
     Histogram binning
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>ImageJ: Thresholding</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-thresholding">
   Global thresholding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-objects">
   Creating objects
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-measuring-rois">
     Generating &amp; measuring ROIs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-labeled-images">
     Generating labeled images
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#local-thresholding">
   Local thresholding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#addendum-practical-issues">
   Addendum: Practical issues
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-nans">
     Using NaNs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#histogram-binning">
     Histogram binning
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="imagej-thresholding">
<h1>ImageJ: Thresholding<a class="headerlink" href="#imagej-thresholding" title="Permalink to this headline">#</a></h1>
<div class="cell tag_hide-cell tag_thebe-init docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%load_ext autoreload
%autoreload 2

# Default imports
import sys
sys.path.append(&#39;../../../&#39;)
from helpers import *
from matplotlib import pyplot as plt
from myst_nb import glue
import numpy as np
from scipy import ndimage
</pre></div>
</div>
</div>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Here, we will explore some ImageJ’s methods to apply thresholds to images, generating binary images, labeled images and ROIs.
We will also confront some of the associated complications.</p>
</section>
<section id="global-thresholding">
<h2>Global thresholding<a class="headerlink" href="#global-thresholding" title="Permalink to this headline">#</a></h2>
<p>The main thresholding command in ImageJ is <span class="menuselection">Image ‣ Adjust ‣ Threshold…</span>, with the shortcut <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Shift</kbd> <kbd class="kbd docutils literal notranslate"></kbd>+<kbd class="kbd docutils literal notranslate"></kbd> <kbd class="kbd docutils literal notranslate">T</kbd></kbd>.</p>
<p>This opens a <em>Threshold</em> dialog that allows you to identify pixels above a threshold, below a threshold, or falling between two thresholds.
These options are controlled using a combination of the threshold sliders and the <span class="guilabel">Dark background</span> checkbox.
There is also a drop-down menu allowing you to select from a list of automated thresholding methods.</p>
<figure class="align-center" id="fig-thresholds-imagej-dialog">
<img alt="../../../_images/imagej-thresholds-dialog.png" src="../../../_images/imagej-thresholds-dialog.png" />
</figure>
<p>During preview, the pixels that are considered foreground are shown in red by default (it’s possible to change this, but I never do).
After choosing suitable thresholds, pressing <span class="guilabel">Apply</span> produces a binary image.
This replaces the original, so it may be wise to duplicate the image first.</p>
<div class="info admonition">
<p class="admonition-title">Binary images in ImageJ</p>
<p>Although only one 1 bit is really needed for each pixel in a binary image, the implementation in ImageJ currently uses 8 bits – and so the actual pixel values allowed are 0 and 255.
To complicate matters, ImageJ also permits <em>either</em> of these to represent the foreground, with the choice hidden away under <span class="menuselection">Process ‣ Binary ‣ Options…</span>, and 0 taken to be ‘black’ and 255 ‘white’.
Personally, I prefer for white to represent the foreground (i.e.
the interesting things we have detected), and so I will assume that the <span class="guilabel">Black background</span> option has been checked.</p>
<p>Nevertheless, you should be aware that this convention is not adopted universally.
Furthermore, if you choose <span class="guilabel">Invert LUT</span> then the colors are flipped anyway – so yet more confusion arises.
Therefore if you find that any processing of binary images gives odd results, be sure to check the binary options and LUT status.</p>
</div>
<p>The <em>Threshold</em> dialog is good for interactively exploring different automated thresholding methods, but it can be hard to systematically compare them.
<span class="menuselection">Image ‣ Adjust ‣ Auto Threshold…</span> helps with this, by providing an option to try <em>all</em> of the methods.</p>
<figure class="align-center" id="fig-thresholds-imagej-all-dialog">
<img alt="../../../_images/imagej-thresholds-all-dialog.png" src="../../../_images/imagej-thresholds-all-dialog.png" />
</figure>
<p>Applying this to ImageJ’s famous <em>blobs.gif</em> reveals that not all methods work equally well:</p>
<figure class="align-center" id="fig-thresholds-imagej-all-blobs">
<img alt="../../../_images/imagej-thresholds-all-blobs.png" src="../../../_images/imagej-thresholds-all-blobs.png" />
</figure>
<div class="tip admonition">
<p class="admonition-title">Automated threshold methods</p>
<p>The various automated thresholds are described at <a class="reference external" href="https://imagej.net/Auto_Threshold">https://imagej.net/Auto_Threshold</a>, often with references to the original published papers upon which they are based.</p>
</div>
</section>
<section id="creating-objects">
<h2>Creating objects<a class="headerlink" href="#creating-objects" title="Permalink to this headline">#</a></h2>
<p>Once we have a binary image, the next step is to identify objects for further exploration.</p>
<section id="generating-measuring-rois">
<h3>Generating &amp; measuring ROIs<a class="headerlink" href="#generating-measuring-rois" title="Permalink to this headline">#</a></h3>
<p>ROIs are a good way to represent objects in ImageJ, because they are easy to measure.
In 2D, there are several options to generate ROIs from a thresholded image, each with slightly different applications:</p>
<ul class="simple">
<li><p>Click on an object with the <em>Wand tool</em> <img alt="../../../_images/wand.png" src="../../../_images/wand.png" /> – this is good for interactively choosing one connected region.</p></li>
<li><p><span class="menuselection">Edit ‣ Selection ‣ Create Selection</span> – this makes a single ROI containing all the foreground pixels.
Disconnected regions can be separated by adding the ROI to the <em>ROI Manager</em> and choosing <span class="guilabel">More &gt;&gt; Split</span>.</p></li>
<li><p><span class="menuselection">Analyze ‣ Analyze Particles…</span> – this detects and measures all the foreground regions as individual objects, optionally filtering out objects based on shape or area.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Creating ROIs without applying a threshold</p>
<p>The <em>Wand tool</em> <img alt="../../../_images/wand.png" src="../../../_images/wand.png" />, <span class="menuselection">Edit ‣ Selection ‣ Create Selection</span> &amp; <span class="menuselection">Analyze ‣ Analyze Particles…</span> can also be used when a threshold is being previewed on an image, but it has not yet been converted to binary.
Therefore you may not need to press <span class="guilabel">Apply</span> in the <em>Threshold</em> dialog at all.</p>
<p>In fact, because it’s not 100% clear whether black or white pixels represent the foreground in an ImageJ binary image, I tend to set a threshold even on an image that <em>is</em> already binary.
That way I can visualize what any of these commands will treat as foreground: with the default thresholding display, the foreground is highlighted in red.</p>
</div>
<p>I like the fact that <span class="menuselection">Edit ‣ Selection ‣ Create Selection</span> provides a very quick way to convert a thresholded region to a single ROI.
I most often use it in combination with <span class="menuselection">Edit ‣ Selection ‣ Restore Selection</span> to visualize what has been detected on top of another image.
I might not necessarily <em>use</em> the single ROI for measurements in the end, but it can be very good for orientation.</p>
<p>When you want to measure multiple objects quickly, <span class="menuselection">Analyze ‣ Analyze Particles…</span> is arguably the most automated and versatile option.
Its various options also make it possible to ignore regions that are particularly small or large, straight or round (using a <span class="guilabel">Circularity</span> metric).
It can output summary results and add ROIs for each region to the <em>ROI Manager</em>.</p>
<figure class="align-center">
<img alt="../../../_images/imagej-thresholds-analyze-dialog.png" src="../../../_images/imagej-thresholds-analyze-dialog.png" />
</figure>
<div class="info admonition">
<p class="admonition-title">Redirecting measurements</p>
<p>Although binary images can show the shapes of things to be measured, pixel intensity measurements made on a binary image are not very helpful.
You could use the above techniques to make ROIs from binary images, then apply those to the original image to get meaningful measurements.</p>
<p>It’s possible to do this by changing the <span class="guilabel">Redirect to:</span> option under <span class="menuselection">Analyze ‣ Set Measurements…</span>, which redirects measurements to be made on a specific image.
Setting a redirection image before running <span class="menuselection">Analyze ‣ Analyze Particles…</span> means that the ROI ‘particles’ can be detected on one image and measured on a different image</p>
<p>I don’t usually recommend this, since I imagine I might forget to reset the <span class="guilabel">Redirect to:</span> option when I am done.
I’d rather add my ROIs to the <em>ROI Manager</em> and transfer them that way.</p>
</div>
<div class="warning admonition">
<p class="admonition-title">Caution with holey ROIs</p>
<p>Historically, there has been a problem with my preferred approach to use the <em>ROI Manager</em> output from <span class="menuselection">Analyze ‣ Analyze Particles…</span>.</p>
<p>It seems that <span class="menuselection">Analyze Particles…</span> handles holes correctly when making measurements by itself, but by default it would generate ROIs that lacked holes.
This meant that if you would measure the ROIs later you could get different results, because the ROIs included extra pixels that were actually excluded (as holes) in the thresholded image.</p>
<figure class="align-center" id="id1" style="width: 90%">
<img alt="../../../_images/imagej-thresholds-analyze-holes.png" src="../../../_images/imagej-thresholds-analyze-holes.png" />
<figcaption>
<p><span class="caption-number">Fig. 76 </span><span class="caption-text">Different results when using <span class="menuselection">Analyze ‣ Analyze Particles…</span> directly, and then subsequently measuring the ROI that it generated. The image is binary, so the mean value should be 255 if only the above-threshold pixels are measured.</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>However</strong>, there is a solution – which I only learned when writing about it here.
Since ImageJ v1.53g, there is a <span class="guilabel">Composite ROIs</span> checkbox when using <span class="menuselection">Analyze Particles…</span>.
If this is turned <strong>on</strong>, then ROIs with holes are generated as expected.</p>
<figure class="align-center" id="id2" style="width: 90%">
<img alt="../../../_images/imagej-thresholds-analyze-composite.png" src="../../../_images/imagej-thresholds-analyze-composite.png" />
<figcaption>
<p><span class="caption-number">Fig. 77 </span><span class="caption-text">Fixing the problem with holey regions by using <span class="guilabel">Composite ROIs</span>.</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This demonstrates the need to be cautious with any image analysis software, and to check out the various options associated with even common commands.
They aren’t <em>always</em> doing what you might expect.</p>
</div>
</section>
<section id="generating-labeled-images">
<h3>Generating labeled images<a class="headerlink" href="#generating-labeled-images" title="Permalink to this headline">#</a></h3>
<p>ROIs are not the only way to represent image objects: sometimes labeled images are more useful.</p>
<p><span class="menuselection">Analyze ‣ Analyze Particles…</span> can generate labeled images by using the <span class="guilabel">Show: Count Masks</span> option.
This will generate a new image in which each pixel has a unique integer value indicating the number of the object it is part of – or zero if it is in the background.
With a suitably colorful LUT (often <span class="menuselection">Image ‣ Lookup Tables ‣ Glasbey</span>), this can create a helpful and cheerful display of objects (<a class="reference internal" href="thresholding.html#fig-blobs-binary-label"><span class="std std-numref">Fig. 61</span></a>).</p>
<figure class="align-center" id="id3" style="width: 90%">
<img alt="../../../_images/imagej-thresholds-analyze-labels.png" src="../../../_images/imagej-thresholds-analyze-labels.png" />
<figcaption>
<p><span class="caption-number">Fig. 78 </span><span class="caption-text">Creating a labeled image with <span class="menuselection">Analyze ‣ Analyze Particles</span>.</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="sd-tab-set docutils">
<input checked="checked" id="169ab3b7-682a-403d-abe9-fd7c91d63b4b" name="e899bb59-3412-4321-933b-284a87d14a5f" type="radio">
</input><label class="sd-tab-label" for="169ab3b7-682a-403d-abe9-fd7c91d63b4b">
Practical</label><div class="sd-tab-content docutils">
<p><a class="reference internal" href="thresholding.html#sec-thresholds-connectivity"><span class="std std-ref">Connectivity</span></a> (4 or 8) is an important consideration when converting a binary image to objects, since it can have a major impact on the number and size of objects.</p>
<p>Work out what kind of connectivity is used by</p>
<ul class="simple">
<li><p><span class="menuselection">Analyze ‣ Analyze Particles…</span></p></li>
<li><p>the <em>Wand tool</em> <img alt="../../../_images/wand.png" src="../../../_images/wand.png" /></p></li>
</ul>
<p><strong>Note:</strong> You can investigate this by applying the commands/tools to a binary image that has some diagonally connected pixels.
One way to do this is by thresholding a suitable image, another is to use the <em>Brush tool</em> <img alt="../../../_images/brush.png" src="../../../_images/brush.png" /> to draw your own pixels in the binary image.</p>
<p><a class="reference external" href="https://ij.imjoy.io/"><img alt="launch ImageJ.JS" src="https://ij.imjoy.io/assets/badge/open-in-imagej-js-badge.svg" /></a></p>
</div>
<input id="1b9bbc71-cbff-4d80-b956-d6497bd2887e" name="e899bb59-3412-4321-933b-284a87d14a5f" type="radio">
</input><label class="sd-tab-label" for="1b9bbc71-cbff-4d80-b956-d6497bd2887e">
Solution</label><div class="sd-tab-content docutils">
<p>At the time of writing, <span class="menuselection">Analyze ‣ Analyze Particles…</span> uses 8-connectivity.</p>
<p>For the <em>Wand tool</em> the right answer will depend upon the setting you see if you double-click the tool.
There are three options: 4-connectivity, 8-connectivity and ‘legacy’ (where ‘legacy’ seems to behave a bit like 8-connectivity).</p>
<a class="reference internal image-reference" href="../../../_images/imagej-thresholds-wand-dialog.png"><img alt="../../../_images/imagej-thresholds-wand-dialog.png" class="align-center" src="../../../_images/imagej-thresholds-wand-dialog.png" style="width: 40%;" /></a>
</div>
</div>
</section>
</section>
<section id="local-thresholding">
<h2>Local thresholding<a class="headerlink" href="#local-thresholding" title="Permalink to this headline">#</a></h2>
<p>A few methods to perform local thresholding can be found under <span class="menuselection">Image ‣ Adjust ‣ Auto Local Threshold</span>.
The dialog again provides the option to try all of them.</p>
<figure class="align-center" id="fig-thresholds-imagej-local-dialog">
<img alt="../../../_images/imagej-thresholds-local-dialog.png" src="../../../_images/imagej-thresholds-local-dialog.png" />
</figure>
<p>Using automated local filters is complicated by the fact that window sizes and parameters need to be tuned.
What these mean in each case is described at <a class="reference external" href="https://imagej.net/Auto_Local_Threshold">https://imagej.net/Auto_Local_Threshold</a></p>
<p>Currently, ImageJ’s local thresholding also requires that the image is converted to 8-bit.
This should be done with some caution, since it can involve surreptitiously incorporating the <a class="reference internal" href="../../1-concepts/3-bit_depths/imagej.html#sec-bit-depths-converting"><span class="std std-ref">brightness &amp; contrast settings</span></a> into the thresholding.</p>
<p>For these reasons, I tend to avoid local thresholding.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="387806da-4d3d-47b3-91c4-ca9b49139c9a" name="06576965-cf46-4e84-b68c-67ba10a2a075" type="radio">
</input><label class="sd-tab-label" for="387806da-4d3d-47b3-91c4-ca9b49139c9a">
Practical</label><div class="sd-tab-content docutils">
<p>Explore several automated methods of thresholding the different channels of <span class="menuselection">File ‣ Open samples ‣ HeLa Cells</span>, using both local and global automated thresholds, to draw your own conclusions about which methods you might prefer for different images.</p>
<p><a class="reference external" href="https://ij.imjoy.io/?run=https://gist.github.com/petebankhead/a45e4eed3a90b6374ec7b272db090ec9"><img alt="launch ImageJ.JS" src="https://ij.imjoy.io/assets/badge/open-in-imagej-js-badge.svg" /></a></p>
</div>
</div>
</section>
<section id="addendum-practical-issues">
<h2>Addendum: Practical issues<a class="headerlink" href="#addendum-practical-issues" title="Permalink to this headline">#</a></h2>
<p>We end this section with a brief discussion of a few non-obvious practical issues that impact thresholding, related to bit-depths and image types.</p>
<section id="using-nans">
<span id="sec-thresholding-nans"></span><h3>Using NaNs<a class="headerlink" href="#using-nans" title="Permalink to this headline">#</a></h3>
<p>The first issue appears when you click <span class="guilabel">Apply</span> in the <span class="menuselection">Image ‣ Adjust ‣ Threshold…</span> dialog box for a 32-bit image.
This leads to a prompt asking whether to <span class="guilabel">Set Background Pixels to NaN</span>.</p>
<p>If this is chosen, a binary image is no longer created.
Instead, thresholding results in an image in which the foreground pixels retain their original values, while background pixels are <strong><em>NaN</em></strong>, or <strong><em>Not A Number</em></strong>.</p>
<p><em>NaN</em> is a special value that can only be stored in floating point images, which ImageJ ignores when making measurements later.
It is therefore used to mask out regions, while preserving meaningful pixel values elsewhere.</p>
<p>This is an advanced option that is <em>potentially</em> useful, but can be a bit challenging to work with.
You have to be extra cautious when using an image containing NaNs, since some commands might behave in surprising ways.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="b0a82cfc-aa45-42eb-94cd-3f3835902413" name="5f9b3c90-0bb1-43b8-9cea-3c79806b3918" type="radio">
</input><label class="sd-tab-label" for="b0a82cfc-aa45-42eb-94cd-3f3835902413">
Practical</label><div class="sd-tab-content docutils">
<p>Create an image including NaN pixels, then measure some ROIs drawn on it.
Are area measurements affected by whether NaNs are present or not?</p>
<p><a class="reference external" href="https://ij.imjoy.io/"><img alt="launch ImageJ.JS" src="https://ij.imjoy.io/assets/badge/open-in-imagej-js-badge.svg" /></a></p>
</div>
<input id="a17a71d5-ada7-4124-b5a4-5afd94c43617" name="5f9b3c90-0bb1-43b8-9cea-3c79806b3918" type="radio">
</input><label class="sd-tab-label" for="a17a71d5-ada7-4124-b5a4-5afd94c43617">
Solution</label><div class="sd-tab-content docutils">
<p>They are!
If you measure the area of an image containing NaNs, the result is less than if you measure the area of the same image converted to 8-bit – since only the non-NaN parts are included.
If you measure a region containing NaNs only, the area is 0.</p>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="f48ec053-c0b9-4768-97f7-4ef68054c318" name="0b8e3a95-6cd2-4b65-8eff-1697f5edfc89" type="radio">
</input><label class="sd-tab-label" for="f48ec053-c0b9-4768-97f7-4ef68054c318">
Question</label><div class="sd-tab-content docutils">
<p>Through experiment or guesswork, what do you suppose happens to NaNs with a 32-bit image is converted to 8-bit or 16-bit?</p>
</div>
<input id="10440d53-e44f-4c7a-8f0b-cdfd270cb15f" name="0b8e3a95-6cd2-4b65-8eff-1697f5edfc89" type="radio">
</input><label class="sd-tab-label" for="10440d53-e44f-4c7a-8f0b-cdfd270cb15f">
Answer</label><div class="sd-tab-content docutils">
<p>Since NaN is not an integer, it cannot be stored in an 8-bit or 16-bit unsigned integer image.
Instead, all NaNs simply become zero.</p>
</div>
</div>
</section>
<section id="histogram-binning">
<h3>Histogram binning<a class="headerlink" href="#histogram-binning" title="Permalink to this headline">#</a></h3>
<p>The second way in which bit-depths and types matter is that histograms of images &gt; 8-bit involve <em>binning</em> the data.
For example, with a 32-bit image it would probably not make sense to create a histogram that has separate counts for all possible pixel values: in addition to counts for pixels with exact values 1 and 2, we would have thousands of counts for pixels with fractions in between and most of these counts would be 0.</p>
<p>Instead, the histogram is generated by dividing the total data range (maximum – minimum pixel values) into 256 separate <em>bins</em> with equal widths, and counting how many pixels have values falling into the range of each bin.
It’s therefore like a subtle conversion to 8-bit precision for the threshold calculation, but without actually changing the original data.
The same type of conversion is used for 16-bit images – <em>unless</em> you use the <span class="menuselection">Image ‣ Adjust ‣ Auto Threshold</span> command, which can use a full 16-bit histogram with 65536 bins.</p>
<p>This is where the <span class="guilabel">Don’t reset range</span> option in ImageJ’s thresholding dialog becomes relevant for 16-bit or 32-bit images, when used in combination with the <span class="guilabel">Auto</span> button.</p>
<ul class="simple">
<li><p>If <span class="guilabel">Don’t reset range</span> <strong>is selected</strong>, then the binning uses the current minimum and maximum values in the brightness/contrast dialog</p></li>
<li><p>If <span class="guilabel">Don’t reset range</span> <strong>is <em>not</em> selected</strong>, then the binning <em>resets</em> the minimum and maximum values in the brightness/contrast dialog before using them</p></li>
</ul>
<p>Personally, I find this confusing; I don’t like the brighness/contrast impacting thresholds, and my poor brain even struggles to process the negative in the <span class="guilabel">Don’t reset range</span> to get an intuitive feeling for what effect the option will really have.
And what makes things worse is that ImageJ’s behavior in this regard has changed across versions, so there’s a chance that any specific advice I give here won’t match the version you’re using anyway.</p>
<p>I know I’m not alone in being confused, since this has been the subject of a <a class="reference external" href="https://forum.image.sc/t/auto-threshold-calculation-and-bright-and-contrast-auto-adjust-issue/19301">long discussion on the image.sc forum</a>.
So the main message is: be aware that binning happens, and keep on the lookout for any unexpected effects that the brightness/contrast sliders might sneakily have on thresholding.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="7f879d41-3be3-41d2-99e4-9af14adff53e" name="8bca5d87-a9d7-4888-874d-5337b927d69e" type="radio">
</input><label class="sd-tab-label" for="7f879d41-3be3-41d2-99e4-9af14adff53e">
Practical</label><div class="sd-tab-content docutils">
<p>Explore setting thresholds with and without <span class="guilabel">Don’t reset range</span> selected for the image <span class="menuselection">File ‣ Open Samples ‣ M51 Galaxy (16-bits)</span>, and pressing the <span class="guilabel">Auto</span> button to determine a threshold.</p>
<p>Keep <span class="menuselection">Image ‣ Adjust ‣ Brightness/Contrast…</span> open as you explore, so you can make adjustments before calculating the thresholds.</p>
<figure class="align-center" style="width: 25%">
<img alt="../../../_images/imagej-m51.png" src="../../../_images/imagej-m51.png" />
</figure>
<p><a class="reference external" href="https://ij.imjoy.io/?run=https://gist.github.com/petebankhead/c5d2075777c458c70c69a1f2c8b37391"><img alt="launch ImageJ.JS" src="https://ij.imjoy.io/assets/badge/open-in-imagej-js-badge.svg" /></a></p>
</div>
<input id="71d605ff-d892-4ee3-90ec-e2c2f9bb8136" name="8bca5d87-a9d7-4888-874d-5337b927d69e" type="radio">
</input><label class="sd-tab-label" for="71d605ff-d892-4ee3-90ec-e2c2f9bb8136">
Solution</label><div class="sd-tab-content docutils">
<p>This image shows a potential use of the <span class="guilabel">Don’t reset range</span> option – used cautiously.</p>
<figure class="align-center" id="id4">
<div class="cell_output docutils container">
<img alt="../../../_images/imagej_7_01.png" src="../../../_images/imagej_7_01.png" />
</div>
<figcaption>
<p><span class="caption-number">Fig. 79 </span><span class="caption-text">Thresholding a 16-bit image with and without ‘Don’t reset range’ selected.</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="f9b18504-e6f8-4667-aff6-07776c019230" name="5f5eb470-d0ec-4240-8f3e-a6bb12a20f20" type="radio">
</input><label class="sd-tab-label" for="f9b18504-e6f8-4667-aff6-07776c019230">
Practical</label><div class="sd-tab-content docutils">
<p>What are the implications of using a 256-bin histogram for thresholding a 32-bit image?</p>
<p>In particular, how might any outlier pixels affect the accuracy with which you can define a threshold – automatically or manually?</p>
<p>To explore this, you can use the extreme example of <em>cell_outlier.tif</em> along with the <span class="menuselection">Image ‣ Adjust ‣ Threshold…</span> command.</p>
<p>How could you (manually) reduce the impact of any problems you find?</p>
<p><strong>Note:</strong> <span class="menuselection">Analyze ‣ Histogram</span> lets you investigate the image histogram with different numbers of bins – but any changes you make here will not be reflected in the histogram actually used for thresholding.</p>
<p><a class="reference external" href="https://ij.imjoy.io?open=https://github.com/bioimagebook/practical-data/blob/main/images/cell_outlier.tif"><img alt="launch ImageJ.JS" src="https://ij.imjoy.io/assets/badge/launch-imagej-js-badge.svg" /></a></p>
</div>
<input id="8a5a3df7-f5cc-4a3c-b39e-af02ed89e30c" name="5f5eb470-d0ec-4240-8f3e-a6bb12a20f20" type="radio">
</input><label class="sd-tab-label" for="8a5a3df7-f5cc-4a3c-b39e-af02ed89e30c">
Solution</label><div class="sd-tab-content docutils">
<p>First, a positive implication of using a 256-bit histogram for thresholding is that it can be fast: more bins add to the computations involved.
Also, creating too many bins has the result of making most of them zero – potentially causing some automated threshold-determination algorithms to fail.</p>
<p>A negative implication is that using 256 bins means that only 256 different thresholds are possible: that is, if your image range is 0–25500, then the thresholds you could get are 0, 100, 200, … 25500.
If the optimal threshold is really 150, this will not be found.
But usually if your range of pixel values is this large, you do not need a very fine-grained threshold for acceptable results anyway.</p>
<p>This changes if you have outliers.
A single extreme pixel – which might occur when a pixel in a CCD camera is somehow ‘broken’ – can cause most other pixels in the image to be squeezed into only a few bins.
Then the histogram resolution might really be too small for reasonable thresholding.</p>
<p>It’s a sufficiently obscure problem that hopefully it won’t bother you.
However, if you do experience the issue then two possible ways to overcome it are:</p>
<ol class="simple">
<li><p>Adjust the brightness/contrast sliders and ensure that <span class="guilabel">Don’t reset range</span> <strong>is</strong> selected. This is the benefit of the option existing.</p></li>
<li><p>Convert the image to 8-bit manually yourself. This allows you to effectively choose the range of the histogram bins (using <span class="menuselection">Brightness/Contrast…</span>; see <a class="reference internal" href="../../1-concepts/3-bit_depths/imagej.html#sec-bit-depths-converting"><span class="std std-ref">Types &amp; bit-depths</span></a>) Since the threshold is made using 256 bins, you are not really losing any information that was not going to be lost anyway.</p></li>
</ol>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "bioimagebook/bioimagebook.github.io",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/2-processing/3-thresholding"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="thresholding.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Thresholding</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../4-filters/filters.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Filters</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Pete Bankhead<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>